{
  "hash": "bc10762f045c06c5b74d07f944df4aae",
  "result": {
    "markdown": "---\ntitle: \"Gaussian Process\"\nauthor: \"Simon-Pierre Boucher\"\ndate: \"2023-02-11\"\ncategories: [R, code, Gaussian Process]\nimage: \"https://www.clipartmax.com/png/middle/124-1248944_the-future-of-ai-artificial-intelligence-logo.png\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nmuFn = function(x){\n  x = sapply(x, function(x) x=0)\n  x\n}\n\n# The covariance function; here it is the squared exponential kernel.\n# l is the horizontal scale, sigmaf is the vertical scale.\n# See ?covSEiso in the gpr package for example, which is also based on Rasmussen and\n# Williams Matlab code (gpml Matlab library)\n\nKfn = function(x, l=1, sigmaf=1){\n    sigmaf * exp( -(1/(2*l^2)) * as.matrix(dist(x, upper=T, diag=T)^2) )\n}\n\n\n#####################\n### Preliminaries ###\n#####################\n\nl = 1           # for l, sigmaf, see note at covariance function\nsigmaf = 1      \nkeps = 1e-8     # see note at Kstarstar\nnprior = 5      # number of prior draws\nnpostpred = 3   # number of posterior predictive draws\n\n##################\n### Prior plot ###\n##################\n\n# data setup\nrequire(MASS)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLe chargement a nécessité le package : MASS\n```\n:::\n\n```{.r .cell-code}\nxg1 = seq(-5, 5, .2)\nyg1 = mvrnorm(nprior,\n              mu = muFn(xg1),\n              Sigma = Kfn(xg1, l = l, sigmaf = sigmaf))\n\n# plot prior\nlibrary(ggplot2)\nlibrary(reshape2)\n\n# reshape data for plotting\ngdat = melt(data.frame(\n  x = xg1,\n  y = t(yg1),\n  sd = apply(yg1, 2, sd)\n), id = c('x', 'sd'))\n# head(gdat) # inspect if desired\n\ng1 = ggplot(aes(x = x, y = value), data = gdat) +\n  geom_line(aes(group = variable), color = '#FF5500', alpha = .5) +\n  labs(title = 'Prior') +\n  theme_minimal()\n\n# g1\n\n#########################################\n### generate noise-less training data ###\n#########################################\nXtrain = c(-4, -3, -2, -1, 1)\nytrain = sin(Xtrain)\nnTrain = length(Xtrain)\n\nXtest = seq(-5, 5, .2)\nnTest = length(Xtest)\n\n#####################################\n### generate posterior predictive ###\n#####################################\n\n# Create K, K*, and K** matrices as defined in the texts\nK = Kfn(Xtrain, l=l, sigmaf=sigmaf)  \nK_ = Kfn(c(Xtrain, Xtest), l=l, sigmaf=sigmaf)                                 # initial matrix\nKstar = K_[1:nTrain, (nTrain+1):ncol(K_)]                                      # dim = N x N*\ntKstar = t(Kstar)                                                              # dim = N* x N\nKstarstar = K_[(nTrain+1):nrow(K_), (nTrain+1):ncol(K_)] + keps*diag(nTest)    # dim = N* x N*; the keps part is for positive definiteness\nKinv = solve(K)\n\n# calculate posterior mean and covariance\npostMu = muFn(Xtest) + t(Kstar) %*% Kinv %*% (ytrain-muFn(Xtrain))\npostCov = Kstarstar - t(Kstar) %*% Kinv %*% Kstar\ns2 = diag(postCov)\n# R = chol(postCov)  \n# L = t(R)      # L is used in alternative formulation below based on gaussSample.m\n\n# generate draws from posterior predictive\ny2 = data.frame(t(mvrnorm(npostpred, mu=postMu, Sigma=postCov)))\n# y2 = data.frame(replicate(npostpred, postMu + L %*% rnorm(postMu))) # alternative\n\n#################################\n### Posterior predictive plot ###\n#################################\n\n# reshape data for plotting\ngdat = melt(data.frame(x=Xtest, y=y2, selower=postMu-2*sqrt(s2), seupper=postMu+2*sqrt(s2)),\n            id=c('x', 'selower', 'seupper'))\n\ng2 = ggplot(aes(x=x, y=value), data=gdat) + \n  geom_ribbon(aes(ymin=selower, ymax=seupper,group=variable), fill='gray90') +\n  geom_line(aes(group=variable), color='#FF5500') +\n  geom_point(aes(x=Xtrain, y=ytrain), data=data.frame(Xtrain, ytrain)) +\n  labs(title='Posterior Predictive') +\n  theme_minimal()\n\n# g2\n\n####################################################\n### Plot prior and posterior predictive together ###\n####################################################\n\nlibrary(gridExtra)\ngrid.arrange(g1, g2, ncol=2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}