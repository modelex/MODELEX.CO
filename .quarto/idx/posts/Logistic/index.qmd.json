{"title":"Logistic Regression","markdown":{"yaml":{"title":"Logistic Regression","author":"Simon-Pierre Boucher","date":"2023-02-11","categories":["R","Code","Logistic Regression"],"image":"https://www.clipartmax.com/png/middle/124-1248944_the-future-of-ai-artificial-intelligence-logo.png"},"headingText":"predictors and target","containsRefs":false,"markdown":"\n\nR code to estimate a logistic regression model\n\n```{r}\nset.seed(1235)  # ensures replication\n\n\n\nN = 10000 # sample size\nk = 2     # number of desired predictors\nX = matrix(rnorm(N * k), ncol = k)\n\n# the linear predictor\nlp = -.5 + .2 * X[, 1] + .1 * X[, 2] # increasing N will get estimated values closer to these\n\ny = rbinom(N, size = 1, prob = plogis(lp))\n\ndfXy = data.frame(X, y)\n\n\n\n#' \n#' # Functions \n#' \n#' A maximum likelihood approach.\n\nlogreg_ML = function(par, X, y) {\n  # arguments- \n  # par: parameters to be estimated\n  # X: predictor matrix with intercept column\n  # y: response\n  \n  # setup\n  beta = par                                # coefficients\n  N = nrow(X)\n  \n  # linear predictor\n  LP = X %*% beta                           # linear predictor\n  mu = plogis(LP)                           # logit link\n  \n  # calculate likelihood\n  L = dbinom(y, size = 1, prob = mu, log = TRUE)         # log likelihood\n  #   L =  y*log(mu) + (1 - y)*log(1-mu)    # alternate log likelihood form\n  \n  -sum(L)                                   # optim by default is minimization, and we want to maximize the likelihood \n  # (see also fnscale in optim.control)\n}\n\n# An equivalent approach via exponential loss function.\n\nlogreg_exp = function(par, X, y) {\n  # arguments- \n  # par: parameters to be estimated\n  # X: predictor matrix with intercept column\n  # y: response\n  \n  # setup\n  beta = par                                   # coefficients\n  \n  # linear predictor\n  LP = X %*% beta                              # linear predictor\n\n  # calculate exponential loss function (convert y to -1:1 from 0:1)\n  L = sum(exp(-ifelse(y, 1, -1) * .5 * LP))\n}\n\n\n#' # Obtain Model Estimates\n#' Setup for use with `optim`.\n\nX = cbind(1, X)\n\n# initial values\n\ninit = rep(0, ncol(X))\nnames(init) = c('intercept', 'b1', 'b2')\n\noptlmML = optim(\n  par = init,\n  fn  = logreg_ML,\n  X   = X,\n  y   = y,\n  control = list(reltol = 1e-8)\n)\n\noptglmClass = optim(\n  par = init,\n  fn  = logreg_exp,\n  X   = X,\n  y   = y, \n  control = list(reltol = 1e-15)\n)\n\npars_ML  = optlmML$par\npars_exp = optglmClass$par\n\n\n#' # Comparison\n#' \n#' Compare to `glm`.\n\nmodglm = glm(y ~ ., dfXy, family = binomial)\n\nrbind(\n  pars_ML,\n  pars_exp,\n  pars_GLM = coef(modglm)\n)\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"Logistic Regression","author":"Simon-Pierre Boucher","date":"2023-02-11","categories":["R","Code","Logistic Regression"],"image":"https://www.clipartmax.com/png/middle/124-1248944_the-future-of-ai-artificial-intelligence-logo.png"},"extensions":{"book":{"multiFile":true}}}}}