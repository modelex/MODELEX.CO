{"title":"Ridge","markdown":{"yaml":{"title":"Ridge","author":"Simon-Pierre Boucher","date":"2023-02-11","categories":["R","Code","Ridge"],"image":"https://www.clipartmax.com/png/middle/124-1248944_the-future-of-ai-artificial-intelligence-logo.png"},"headingText":"' Note, if `lambda=0`, result is the same as  `lm.fit`.","containsRefs":false,"markdown":"\n\n```{r}\nridge <- function(w, X, y, lambda = .1) {\n  # X: model matrix; \n  # y: target; \n  # lambda: penalty parameter; \n  # w: the weights/coefficients\n  \n  crossprod(y - X %*% w) + lambda * length(y) * crossprod(w)\n}\n\n\nset.seed(8675309)\nN = 500\np = 10\nX = scale(matrix(rnorm(N * p), ncol = p))\nb = c(.5, -.5, .25, -.25, .125, -.125, rep(0, 4))\ny = scale(X %*% b + rnorm(N, sd = .5))\n\n#' \n#' \nresult_ridge = optim(\n  rep(0, ncol(X)),\n  ridge,\n  X = X,\n  y = y,\n  lambda = .1,\n  method = 'BFGS'\n)\n\n#' Analytical result.\n#' \nresult_ridge2 =  solve(crossprod(X) + diag(length(y)*.1, ncol(X))) %*% crossprod(X, y)\n\n#' Alternative with augmented data (note sigma ignored as it equals 1, but otherwise\n#' X/sigma and y/sigma).\n#' \nX2 = rbind(X, diag(sqrt(length(y)*.1), ncol(X)))\ny2 = c(y, rep(0, ncol(X)))\nresult_ridge3 = solve(crossprod(X2)) %*% crossprod(X2, y2)\n\n\n\n\n#' `glmnet` is by default a mixture of ridge and lasso penalties, setting alpha\n#' = 1 reduces to lasso, while alpha=0 would be ridge.\n\n\nlibrary(glmnet)\nglmnet_res = coef(\n  glmnet(\n    X,\n    y,\n    alpha = 0,\n    lambda = c(10, 1, .1),\n    thresh = 1e-12,\n    intercept = F\n  ), \n  s = .1\n)\n\n#' # Comparison\n\ndata.frame(\n  lm     = coef(lm(y ~ . - 1, data.frame(X))),\n  ridge  = result_ridge$par,\n  ridge2 = result_ridge2,\n  ridge3 = result_ridge3,\n  glmnet = glmnet_res[-1, 1],\n  truth  = b\n)\n\n\n\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"Ridge","author":"Simon-Pierre Boucher","date":"2023-02-11","categories":["R","Code","Ridge"],"image":"https://www.clipartmax.com/png/middle/124-1248944_the-future-of-ai-artificial-intelligence-logo.png"},"extensions":{"book":{"multiFile":true}}}}}