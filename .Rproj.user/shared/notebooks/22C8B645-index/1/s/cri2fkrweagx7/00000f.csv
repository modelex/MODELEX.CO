"0","X = matrix("
"0","  c(0, 0, 1,"
"0","    0, 1, 1,"
"0","    1, 0, 1,"
"0","    1, 1, 1),"
"0","  nrow = 4,"
"0","  ncol = 3,"
"0","  byrow = TRUE"
"0",")"
"0",""
"0","y = matrix(as.integer(xor(X[,1], X[,2])), ncol = 1)  # make the relationship explicit"
"0",""
"0","set.seed(1)"
"0",""
"0","# or do randomly in same fashion"
"0","synapse_0 = matrix(runif(12, -1, 1), 3, 4)"
"0","synapse_1 = matrix(runif(12, -1, 1), 4, 1)"
"2","Avis : data length differs from size of matrix: [12 != 4 x 1]"
"0","# synapse_0"
"0","# synapse_1"
"0",""
"0","nn_2 <- function("
"0","  X,"
"0","  y,"
"0","  synapse_0_start,"
"0","  synapse_1_start,"
"0","  maxiter = 30000,"
"0","  verbose = TRUE"
"0",") {"
"0","    "
"0","  synapse_0 = synapse_0_start"
"0","  synapse_1 = synapse_1_start"
"0","  "
"0","  for (j in 1:maxiter) {"
"0","    layer_1 = plogis(X  %*% synapse_0)              # 4 x 4"
"0","    layer_2 = plogis(layer_1 %*% synapse_1)         # 4 x 1"
"0","    "
"0","    # how much did we miss the target value?"
"0","    layer_2_error = y - layer_2"
"0","    "
"0","    if (verbose && (j %% 10000) == 0) {"
"0","      message(glue::glue(""Error: {mean(abs(layer_2_error))}""))"
"0","    }"
"0","  "
"0","    # in what direction is the target value?"
"0","    # were we really sure? if so, don't change too much."
"0","    layer_2_delta = (y - layer_2) * (layer_2 * (1 - layer_2))"
"0","    "
"0","    # how much did each l1 value contribute to the l2 error (according to the weights)?"
"0","    layer_1_error = layer_2_delta %*% t(synapse_1)"
"0","    "
"0","    # in what direction is the target l1?"
"0","    # were we really sure? if so, don't change too much.  "
"0","    layer_1_delta = tcrossprod(layer_2_delta, synapse_1) * (layer_1 * (1 - layer_1))"
"0","    "
"0","    # update"
"0","    synapse_1 = synapse_1 + crossprod(layer_1, layer_2_delta)"
"0","    synapse_0 = synapse_0 + crossprod(X, layer_1_delta)"
"0","  }"
"0","  "
"0","  list("
"0","    layer_1_error = layer_1_error,"
"0","    layer_2_error = layer_2_error,"
"0","    synapse_0 = synapse_0,"
"0","    synapse_1 = synapse_1,"
"0","    layer_1 = layer_1,"
"0","    layer_2 = layer_2"
"0","  )"
"0","}"
"0",""
"0","fit_nn = nn_2("
"0","  X,"
"0","  y,"
"0","  synapse_0_start = synapse_0,"
"0","  synapse_1_start = synapse_1,"
"0","  maxiter = 30000"
"0",")"
"2","Error: 0.0105538166393651
"
"2","Error: 0.00729252475321203
"
"2","Error: 0.00589736374094261
"
"0","glue::glue('Final error: {round(mean(abs(fit_nn$layer_2_error)), 5)}')"
"1","Final error: 0.0059"
"1","
"
"0","round(fit_nn$layer_1, 3)"
"1","    "
"1","  [,1]"
"1","  [,2]"
"1","  [,3]"
"1","  [,4]"
"1","
[1,]"
"1"," 0.259"
"1"," 0.889"
"1"," 0.364"
"1"," 0.445"
"1","
[2,]"
"1"," 0.000"
"1"," 0.037"
"1"," 0.978"
"1"," 0.030"
"1","
[3,]"
"1"," 0.946"
"1"," 1.000"
"1"," 0.984"
"1"," 0.020"
"1","
[4,]"
"1"," 0.016"
"1"," 0.984"
"1"," 1.000"
"1"," 0.001"
"1","
"
"0","round(cbind(fit_nn$layer_2, y), 3)"
"1","    "
"1","  [,1]"
"1"," [,2]"
"1","
[1,]"
"1"," 0.002"
"1","    0"
"1","
[2,]"
"1"," 0.993"
"1","    1"
"1","
[3,]"
"1"," 0.994"
"1","    1"
"1","
[4,]"
"1"," 0.008"
"1","    0"
"1","
"
"0","round(fit_nn$synapse_0, 3)"
"1","    "
"1","   [,1]"
"1","   [,2]"
"1","   [,3]"
"1","   [,4]"
"1","
[1,]"
"1","  3.915"
"1","  7.364"
"1","  4.705"
"1"," -3.669"
"1","
[2,]"
"1"," -6.970"
"1"," -5.351"
"1","  4.337"
"1"," -3.242"
"1","
[3,]"
"1"," -1.050"
"1","  2.079"
"1"," -0.559"
"1"," -0.221"
"1","
"
"0","round(fit_nn$synapse_1, 3)"
"1","    "
"1","    [,1]"
"1","
[1,]"
"1","  10.988"
"1","
[2,]"
"1"," -10.733"
"1","
[3,]"
"1","   5.576"
"1","
[4,]"
"1","  -2.987"
"1","
"
